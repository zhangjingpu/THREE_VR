THREE.FirstPersonControls2=function(p,f){function g(a){a.preventDefault()}function c(a,b){return function(){b.apply(a,arguments)}}this.object=p;this.target=new THREE.Vector3(0,0,0);this.domElement=void 0!==f?f:document;this.enabled=!0;this.movementSpeed=1;this.lookSpeed=.005;this.lookVertical=!0;this.autoForward=!1;this.activeLook=!0;this.heightSpeed=!1;this.heightCoef=1;this.heightMin=0;this.heightMax=1;this.constrainVertical=!1;this.verticalMin=0;this.verticalMax=Math.PI;this.theta=this.phi=this.lon=
    this.lat=this.mouseY=this.mouseX=this.autoSpeedFactor=0;this.mouseDragOn=this.moveRight=this.moveLeft=this.moveBackward=this.moveForward=!1;this.viewHalfY=this.viewHalfX=0;this.renderScene=function(){};this.domElement!==document&&this.domElement.setAttribute("tabindex",-1);this.handleResize=function(){this.viewHalfY=this.viewHalfX=0};this.onMouseDown=function(a){this.domElement!==document&&this.domElement.focus();a.preventDefault();a.stopPropagation();if(this.activeLook)switch(a.button){case 0:case 2:this.viewHalfX=
    a.pageX,this.viewHalfY=a.pageY}this.mouseDragOn=!0;this.domElement.addEventListener("mousemove",d,!1);this.domElement.addEventListener("mouseup",e,!1);this.renderScene()};this.onMouseUp=function(a){a.preventDefault();a.stopPropagation();this.mouseY=this.mouseX=0;this.domElement.removeEventListener("mousemove",d,!1);this.domElement.removeEventListener("mouseup",e,!1);this.renderScene()};this.onMouseMove=function(a){this.domElement===document?(this.mouseX=a.pageX-this.viewHalfX,this.mouseY=a.pageY-
    this.viewHalfY):(this.mouseX=a.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=a.pageY-this.domElement.offsetTop-this.viewHalfY);this.renderScene()};this.onKeyDown=function(a){a.preventDefault();switch(a.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0}this.renderScene()};this.onKeyUp=function(a){switch(a.keyCode){case 38:case 87:this.moveForward=
    !1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}this.renderScene()};this.update=function(a){if(!1!==this.enabled){if(this.heightSpeed){var b=THREE.Math.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=a*b*this.heightCoef}else this.autoSpeedFactor=0;b=a*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&
this.object.translateZ(-(b+this.autoSpeedFactor));this.moveBackward&&this.object.translateZ(b);this.moveLeft&&this.object.translateX(-b);this.moveRight&&this.object.translateX(b);this.moveUp&&this.object.translateY(b);this.moveDown&&this.object.translateY(-b);a*=this.lookSpeed;this.activeLook||(a=0);b=1;this.constrainVertical&&(b=Math.PI/(this.verticalMax-this.verticalMin));this.lon+=this.mouseX*a;this.lookVertical&&(this.lat-=this.mouseY*a*b);this.lat=Math.max(-85,Math.min(85,this.lat));this.phi=
    THREE.Math.degToRad(90-this.lat);this.theta=THREE.Math.degToRad(this.lon);this.constrainVertical&&(this.phi=THREE.Math.mapLinear(this.phi,0,Math.PI,this.verticalMin,this.verticalMax));0!=this.theta&&(a=this.target,b=this.object.position,a.x=b.x+100*Math.sin(this.phi)*Math.cos(this.theta),a.y=b.y+100*Math.cos(this.phi),a.z=b.z+100*Math.sin(this.phi)*Math.sin(this.theta),this.object.lookAt(a))}};this.onTouchStart=function(a){this.domElement!==document&&this.domElement.focus();a.preventDefault();a.stopPropagation();
    this.activeLook&&(this.viewHalfX=a.touches[0].pageX,this.viewHalfY=a.touches[0].pageY);this.mouseDragOn=!0;this.domElement.addEventListener("touchmove",h,!1);this.domElement.addEventListener("touchend",k,!1)};this.onTouchMove=function(a){this.domElement===document?(this.mouseX=a.touches[0].pageX-this.viewHalfX,this.mouseY=a.touches[0].pageY-this.viewHalfY):(this.mouseX=a.touches[0].pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=a.touches[0].pageY-this.domElement.offsetTop-this.viewHalfY)};
    this.onTouchEnd=function(a){a.preventDefault();a.stopPropagation();this.mouseY=this.mouseX=0;this.domElement.removeEventListener("touchmove",h,!1);this.domElement.removeEventListener("touchend",k,!1)};this.dispose=function(){this.domElement.removeEventListener("contextmenu",g,!1);this.domElement.removeEventListener("mousedown",l,!1);this.domElement.removeEventListener("mousemove",d,!1);this.domElement.removeEventListener("mouseup",e,!1);window.removeEventListener("keydown",m,!1);window.removeEventListener("keyup",
        n,!1);this.renderScene()};var d=c(this,this.onMouseMove),l=c(this,this.onMouseDown),e=c(this,this.onMouseUp),m=c(this,this.onKeyDown),n=c(this,this.onKeyUp),q=c(this,this.onTouchStart),h=c(this,this.onTouchMove),k=c(this,this.onTouchEnd);this.domElement.addEventListener("contextmenu",g,!1);this.domElement.addEventListener("mousedown",l,!1);this.domElement.addEventListener("touchstart",q,!1);window.addEventListener("keydown",m,!1);window.addEventListener("keyup",n,!1);this.handleResize()};